<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éœ€è¡¥å……æ ¸æŸ¥çš„æ ¸å¿ƒèµ„æ–™æ¸…å•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            line-height: 1.6;
            color: #343a40;
            max-width: 900px;
            margin: 40px auto;
            padding: 0 20px;
            background-color: #f8f9fa;
        }
        h1, h2 {
            color: #2c3e50;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }
        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        h2 {
            font-size: 1.8em;
            margin-top: 50px;
            margin-bottom: 30px;
        }
        .intro-text {
            font-size: 1.1em;
            margin-bottom: 40px;
            text-align: center;
            color: #6c757d;
        }
        .item-list {
            list-style-type: none;
            padding-left: 0;
            counter-reset: item-counter;
        }
        .list-item {
            background-color: #ffffff;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .list-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.08);
        }
        .item-content {
            display: flex;
            align-items: center;
            flex-grow: 1;
        }
        .item-content::before {
            counter-increment: item-counter;
            content: counter(item-counter);
            font-size: 1.2em;
            font-weight: bold;
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            margin-right: 20px;
            flex-shrink: 0;
        }
        .item-text {
            margin: 0;
        }
        .view-btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            transition: background-color 0.2s;
            flex-shrink: 0;
            margin-left: 20px;
        }
        .view-btn:hover {
            background-color: #0056b3;
        }
        .view-btn.disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        footer {
            text-align: center;
            margin-top: 60px;
            font-size: 0.9em;
            color: #6c757d;
        }
        .grouped-item {
            flex-direction: column;
            align-items: stretch;
        }
        .grouped-item .item-content {
            padding-bottom: 10px;
        }
        .grouped-item .sub-item::before {
            counter-increment: none;
            content: "â€¢";
            background-color: transparent;
            color: #6c757d;
            font-weight: bold;
            font-size: 1.5em;
            line-height: 0;
            margin-right: 16px;
        }
        .grouped-item .grouped-button-container {
            text-align: center;
            margin-top: 10px;
            padding-top: 15px;
            border-top: 1px solid #e9ecef;
        }
        .no-content-notice {
            color: #dc3545;
            font-weight: bold;
            font-size: 1em;
            margin-left: 20px;
            flex-shrink: 0;
        }
        .button-group {
            display: flex;
            gap: 10px;
            flex-shrink: 0;
            margin-left: 20px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.85);
        }
        .modal-content-container {
            position: relative;
            margin: 5% auto;
            padding: 0;
            width: 90%;
            max-width: 1000px;
            background: #fff;
            border-radius: 8px;
        }
        .modal-content-container.gallery { max-width: 800px; background: transparent; }
        .modal-content-container.document, .modal-content-container.listing { height: 85vh; }
        .close {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 25px;
            font-size: 35px;
            font-weight: bold;
            transition: 0.3s;
            z-index: 1001;
        }
        .modal-content-container.gallery .close {
            color: white;
            top: 15px;
            right: 35px;
        }
        .close:hover, .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
        #modal-dynamic-content {
            height: 100%;
            box-sizing: border-box;
        }
        .slideshow-container { position: relative; height: 100%; }
        .mySlides { display: none; height: 100%; }
        .mySlides img { width: 100%; height: 100%; object-fit: contain; }
        .prev, .next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 16px;
            margin-top: -22px;
            color: white;
            font-weight: bold;
            font-size: 20px;
            transition: 0.6s ease;
            border-radius: 0 3px 3px 0;
            user-select: none;
            background-color: rgba(0,0,0,0.3);
        }
        .next { right: 0; border-radius: 3px 0 0 3px; }
        .prev:hover, .next:hover { background-color: rgba(0,0,0,0.8); }

        /* Directory Listing Styles */
        .dir-listing-container, .preview-container {
            padding: 20px;
            height: 100%;
            overflow-y: auto;
            box-sizing: border-box;
        }
        .dir-listing-container ul { list-style: none; padding: 0; }
        .dir-listing-container h3 { margin-top: 0; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
        .dir-listing-container li {
            padding: 10px 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
        }
        .dir-listing-container li.is-folder {
            cursor: pointer;
            font-weight: bold;
        }
        .dir-listing-container li.is-folder:hover {
            background-color: #f9f9f9;
        }
        .dir-listing-container li.is-file { cursor: pointer; }
        .dir-listing-container li.is-file:hover { background-color: #f0f0f0; }
        .dir-listing-container li.is-folder::before { content: 'ğŸ“'; margin-right: 10px; font-size: 1.2em; }
        .dir-listing-container li.is-file::before { content: 'ğŸ“„'; margin-right: 10px; font-size: 1.2em; }
        .dir-listing-container li.is-pdf::before { content: 'ğŸ“•'; }
        .dir-listing-container li.is-image::before { content: 'ğŸ–¼ï¸'; }
        .dir-listing-container ul ul {
            padding-left: 25px;
            display: none; /* Initially hide sub-lists */
        }
        .dir-listing-container ul ul.expanded {
            display: block; /* Show when expanded */
        }

        .back-btn {
            margin-bottom: 15px;
            padding: 8px 15px;
            cursor: pointer;
            border: 1px solid #ccc;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        .preview-content {
            width: 100%;
            height: calc(100% - 50px); /* Adjust height to account for back button */
        }
    </style>
</head>
<body>

    <h1>éœ€è¡¥å……æ ¸æŸ¥çš„æ ¸å¿ƒèµ„æ–™æ¸…å•</h1>
    <p class="intro-text">ä¸ºè¿›ä¸€æ­¥å¤¯å®åˆä½œåŸºç¡€ï¼Œè§„é¿æ½œåœ¨é£é™©ï¼Œéœ€åˆä½œæ–¹è¡¥å……æä¾›ä»¥ä¸‹æ ¸å¿ƒèµ„æ–™ä¾›æ ¸æŸ¥ï¼š</p>

    <h2>ï¼ˆä¸€ï¼‰è‚¡æƒä¸æ²»ç†ç»“æ„èµ„æ–™</h2>
    <ul class="item-list">
        <li class="list-item">
            <div class="item-content"><p class="item-text">è‚¡æƒç»“æ„å›¾ï¼ˆéœ€ç©¿é€è‡³å®é™…æ§åˆ¶äººï¼Œæ˜ç¡®å„å±‚çº§æŒè‚¡æ¯”ä¾‹ï¼‰</p></div>
            <button class="view-btn" data-modal-type="gallery" data-files='["è‚¡æƒæ¶æ„å›¾1.png", "è‚¡æƒæ¶æ„å›¾2.png", "è‚¡æƒæ¶æ„å›¾3.png", "è‚¡æƒæ¶æ„å›¾4.png", "è‚¡æƒæ¶æ„å›¾5.png", "è‚¡æƒæ¶æ„å›¾6.png"]'>æŸ¥çœ‹</button>
        </li>
        <li class="list-item grouped-item">
            <div class="item-content"><p class="item-text">è¿‘ä¸‰å¹´è‚¡ä¸œä¼šã€è‘£äº‹ä¼šã€ç›‘äº‹ä¼šå†³è®®åŠå®Œæ•´ä¼šè®®çºªè¦</p></div>
            <div class="item-content sub-item"><p class="item-text">è‘£äº‹ã€ç›‘äº‹ã€é«˜çº§ç®¡ç†äººå‘˜åå•ï¼ŒåŒ…å«å§“åã€èŒåŠ¡ã€ä»»æœŸã€è¯¦ç»†ç®€å†åŠå¤–éƒ¨å…¼èŒæƒ…å†µè¯´æ˜</p></div>
            <div class="item-content sub-item"><p class="item-text">è‚¡æƒè´¨æŠ¼ã€æœŸæƒæˆäºˆã€è‚¡æƒä»£æŒç­‰æƒç›Šé™åˆ¶ç›¸å…³åè®®åŠç™»è®°è¯æ˜</p></div>
            <div class="grouped-button-container">
                <button class="view-btn" data-modal-type="document" data-doc-type="word" data-file-path="æ·±åœ³æ˜Ÿå¹»åŠ¨ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸ç« ç¨‹.docx">æŸ¥çœ‹</button>
            </div>
        </li>
    </ul>

    <h2>ï¼ˆäºŒï¼‰è´¢åŠ¡ç›¸å…³èµ„æ–™</h2>
    <ul class="item-list">
        <li class="list-item">
            <div class="item-content"><p class="item-text">è¿‘ä¸‰å¹´ç»ç¬¬ä¸‰æ–¹æœºæ„å®¡è®¡çš„è´¢åŠ¡æŠ¥å‘Šï¼ˆå«èµ„äº§è´Ÿå€ºè¡¨ã€åˆ©æ¶¦è¡¨ã€ç°é‡‘æµé‡è¡¨åŠé™„æ³¨ï¼‰</p></div>
            <span class="no-content-notice">æ— </span>
        </li>
        <li class="list-item">
            <div class="item-content"><p class="item-text">è¿‘ 6 ä¸ªæœˆæœˆåº¦è´¢åŠ¡æŠ¥è¡¨ï¼ˆå«èµ„äº§è´Ÿå€ºè¡¨ã€åˆ©æ¶¦è¡¨ã€ç°é‡‘æµé‡è¡¨ï¼‰</p></div>
            <span class="no-content-notice">æ— </span>
        </li>
        <li class="list-item">
            <div class="item-content"><p class="item-text">çŸ­å‰§é¡¹ç›®åŠç”µå•†ä¸šåŠ¡ç›¸å…³çš„ã€Šé¡¹ç›®é¢„ç®—è¡¨ã€‹ã€Šé¡¹ç›®è¿›åº¦ç®¡ç†è¡¨ã€‹ï¼ˆéœ€æ˜ç¡®æˆæœ¬æ„æˆã€æ”¶ç›Šé¢„æµ‹åŠæ—¶é—´èŠ‚ç‚¹ï¼‰</p></div>
            <div class="button-group">
                <button class="view-btn" data-modal-type="document" data-doc-type="excel" data-file-path="è¿‘1-2å¹´å·²å®Œæˆçš„çŸ­å‰§é¡¹ç›®æ¸…å•/é¡¹ç›®é¢„ç®—è¡¨.xlsx">é¡¹ç›®é¢„ç®—è¡¨</button>
                <button class="view-btn" data-modal-type="document" data-doc-type="excel" data-file-path="è¿‘1-2å¹´å·²å®Œæˆçš„çŸ­å‰§é¡¹ç›®æ¸…å•/æµ·å—é¡¹ç›®è¿›ç¨‹è¡¨.xlsx">é¡¹ç›®è¿›åº¦ç®¡ç†è¡¨</button>
            </div>
        </li>
    </ul>

    <h2>ï¼ˆä¸‰ï¼‰é‡å¤§åˆåŒä¸ä¸šåŠ¡èµ„æ–™</h2>
    <ul class="item-list">
        <li class="list-item">
            <div class="item-content"><p class="item-text">é‡‘é¢è¶… 30 ä¸‡å…ƒçš„åˆåŒå°è´¦åŠåŸä»¶ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºå†…å®¹é‡‡è´­ / åˆ¶ä½œåˆåŒã€æ¸ é“åˆä½œåè®®ã€å¹¿å‘Š / ä»˜è´¹ä¸šåŠ¡åˆåŒã€çŸ¥è¯†äº§æƒæˆæƒå</p></div>
            <button class="view-btn" data-modal-type="gallery" data-files='["åˆåŒ-1.jpg", "åˆåŒ-2.jpg", "åˆåŒ-3.jpg", "åˆåŒ-4.jpg", "åˆåŒ-5.jpg", "åˆåŒ-6.jpg", "åˆåŒ-7.jpg", "åˆåŒ-8.jpg", "åˆåŒ-9.jpg"]'>æŸ¥çœ‹</button>
        </li>
        <li class="list-item">
            <div class="item-content"><p class="item-text">è¿‘ 1-2 å¹´å·²å®Œæˆçš„çŸ­å‰§é¡¹ç›®æ¸…å•ï¼ˆå«é¡¹ç›®åç§°ã€ä¸Šçº¿æ—¶é—´ã€æ’­æ”¾é‡ã€è¥æ”¶æ•°æ®ç­‰ï¼‰</p></div>
            <button class="view-btn" data-modal-type="document" data-doc-type="excel" data-file-path="è¿‘1-2å¹´å·²å®Œæˆçš„çŸ­å‰§é¡¹ç›®æ¸…å•/8éƒ¨é¦–å‘è¯•çœ‹é“¾æ¥æ–‡ä»¶.xlsx">æŸ¥çœ‹</button>
        </li>
        <li class="list-item">
            <div class="item-content"><p class="item-text">çŸ­å‰§é¡¹ç›®åŸºç¡€èµ„æ–™ï¼Œæ¶µç›–å‰§æœ¬åˆ›ä½œå§”æ‰˜åˆåŒã€æ‹æ‘„æœåŠ¡å§”æ‰˜åˆåŒç­‰æ ¸å¿ƒåè®®ï¼ŒåŠæ‹æ‘„è®¾å¤‡è‡ªæœ‰ / ç§Ÿèµæ¸…å•ä¸ç›¸å…³åˆåŒ</p></div>
            <button class="view-btn" data-modal-type="listing" data-directory-id="shortDramaBasic">æŸ¥çœ‹</button>
        </li>
    </ul>

    <h2>ï¼ˆå››ï¼‰èµ„è´¨ä¸åˆè§„æ–‡ä»¶</h2>
    <ul class="item-list">
        <li class="list-item">
            <div class="item-content"><p class="item-text">è¥ä¸šæ‰§ç…§ã€å¹¿æ’­ç”µè§†èŠ‚ç›®åˆ¶ä½œç»è¥è®¸å¯è¯ã€ç½‘ç»œæ–‡åŒ–ç»è¥è®¸å¯è¯ï¼ˆè‹¥æ¶‰åŠçº¿ä¸Šä¼ æ’­ï¼‰ç­‰æ ¸å¿ƒè¯ç…§åŸä»¶åŠæœ‰æ•ˆæœŸè¯æ˜</p></div>
            <button class="view-btn" data-modal-type="gallery" data-files='["è¿‘1-2å¹´å·²å®Œæˆçš„çŸ­å‰§é¡¹ç›®æ¸…å•/å¹¿æ’­ç”µè§†èŠ‚ç›®åˆ¶ä½œç»è¥.jpg", "è¿‘1-2å¹´å·²å®Œæˆçš„çŸ­å‰§é¡¹ç›®æ¸…å•/è¥ä¸šæ‰§ç…§.jpg"]'>æŸ¥çœ‹</button>
        </li>
        <li class="list-item">
            <div class="item-content"><p class="item-text">è¿‘ä¸‰å¹´å®Œç¨è¯æ˜ã€æµ·å¤–ç¨åŠ¡ç™»è®°æ–‡ä»¶ã€å¤–æ±‡ç»“ç®—å¤‡æ¡ˆèµ„æ–™</p></div>
            <button class="view-btn" data-modal-type="listing" data-directory-id="taxCertificates">æŸ¥çœ‹</button>
        </li>
        <li class="list-item">
            <div class="item-content"><p class="item-text">ç¨åŠ¡ç­¹åˆ’è¯´æ˜ï¼ˆå¦‚é€‚ç”¨å›½é™…ç¨æ”¶åå®šï¼Œéœ€æ˜ç¡®åå®šæ¡æ¬¾åŠåº”ç”¨æƒ…å†µï¼‰</p></div>
            <button class="view-btn disabled">æŸ¥çœ‹</button>
        </li>
        <li class="list-item">
            <div class="item-content"><p class="item-text">æ‹…ä¿è¯æ˜æ–‡ä»¶ï¼ˆè‹¥å­˜åœ¨è‚¡ä¸œæ‹…ä¿ï¼Œéœ€æä¾›æˆ¿äº§ã€åœŸåœ°ä½¿ç”¨æƒã€è‚¡æƒç­‰æ‹…ä¿è´¢äº§çš„æƒå±è¯æ˜åŠæ‹…ä¿åè®®ï¼‰</p></div>
            <button class="view-btn" data-modal-type="gallery" data-files='["ä¸åŠ¨äº§1.jpg", "ä¸åŠ¨äº§2.jpg"]'>æŸ¥çœ‹</button>
        </li>
    </ul>

    <footer>
        <p>æ–‡æ¡£ç”Ÿæˆäº <span id="generation-date"></span></p>
    </footer>

    <!-- The Modal -->
    <div id="myModal" class="modal">
      <div id="modal-content-container" class="modal-content-container">
        <span class="close">&times;</span>
        <div id="modal-dynamic-content"></div>
      </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('generation-date').textContent = new Date().toLocaleDateString();
        
        const modal = document.getElementById("myModal");
        const modalContentContainer = document.getElementById("modal-content-container");
        const modalDynamicContent = document.getElementById("modal-dynamic-content");
        const closeBtn = modalContentContainer.querySelector(".close");

        const allDirectoryData = {
            "shortDramaBasic": {
                basePath: "çŸ­å‰§é¡¹ç›®åŸºç¡€èµ„æ–™",
                contents: {
                    "åˆä½œåè®®": [
                        "åˆä½œåè®®1.jpg",
                        "åˆä½œåè®®2.jpg",
                        "åˆä½œåè®®3.jpg"
                    ],
                    "å‰§æœ¬åˆ›ä½œ": [
                        "ã€ŠMy Erotic Phone Companionã€‹ä¸€å¡å‰§æœ¬.pdf",
                        "å¥¹æ‰æ˜¯é‚£ä¸ªå¥³å­©0818(3).pdf",
                        "ä¸€å¡ä¸­æ–‡å‰§æœ¬-Sorry,+but+I'm+with+Your+Dad.pdf"
                    ],
                    "è®¾å¤‡æ¸…å•": [
                        "è®¾å¤‡æ¸…å•.jpg"
                    ]
                }
            },
            "taxCertificates": {
                basePath: "", // Root directory
                contents: {
                    "è´¢ç¨æ–‡ä»¶": [
                        "æ·±åœ³æ˜Ÿå¹»åŠ¨ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸2024å¹´å®Œç¨è¯æ˜.pdf",
                        "æ·±åœ³æ˜Ÿå¹»åŠ¨ç½‘ç»œç§‘æŠ€æœ‰é™å…¬å¸2025å¹´å®Œç¨è¯æ˜.pdf",
                        "AirwallexGlobalAccountConfirmation(1).pdf"
                    ]
                }
            }
        };
        
        const openModal = () => modal.style.display = "block";
        const closeModal = () => {
            modal.style.display = "none";
            modalDynamicContent.innerHTML = '';
        };
        closeBtn.onclick = closeModal;
        window.onclick = (event) => { if (event.target == modal) closeModal(); };

        const renderModalContent = (type, data) => {
            modalDynamicContent.innerHTML = '';
            modalContentContainer.className = 'modal-content-container'; // Reset class

            if (type === 'gallery') {
                modalContentContainer.classList.add('gallery');
                const slideshow = document.createElement('div');
                slideshow.className = 'slideshow-container';
                
                const slides = data.files.map(file => {
                    const slideDiv = document.createElement('div');
                    slideDiv.className = 'mySlides';
                    const img = document.createElement('img');
                    img.src = file;
                    slideDiv.appendChild(img);
                    slideshow.appendChild(slideDiv);
                    return slideDiv;
                });

                const prevBtn = document.createElement('a');
                prevBtn.className = 'prev';
                prevBtn.innerHTML = '&#10094;';
                const nextBtn = document.createElement('a');
                nextBtn.className = 'next';
                nextBtn.innerHTML = '&#10095;';

                let slideIndex = 1;
                const showSlides = (n) => {
                    if (n > slides.length) slideIndex = 1;
                    if (n < 1) slideIndex = slides.length;
                    slides.forEach(slide => slide.style.display = "none");
                    slides[slideIndex - 1].style.display = "block";
                };
                prevBtn.onclick = () => showSlides(slideIndex += -1);
                nextBtn.onclick = () => showSlides(slideIndex += 1);
                
                slideshow.appendChild(prevBtn);
                slideshow.appendChild(nextBtn);
                modalDynamicContent.appendChild(slideshow);
                showSlides(slideIndex);

            } else if (type === 'document') {
                modalContentContainer.classList.add('document');
                const iframe = document.createElement('iframe');
                let src = '';
                if (data.docType === 'word' || data.docType === 'excel') {
                    const serverUrl = `${window.location.protocol}//${window.location.host}/`;
                    const fileUrl = encodeURIComponent(serverUrl + data.filePath);
                    src = `https://view.officeapps.live.com/op/view.aspx?src=${fileUrl}`;
                } else { // pdf
                    src = data.filePath;
                }
                iframe.src = src;
                iframe.style.width = '100%';
                iframe.style.height = '100%';
                iframe.frameBorder = '0';
                modalDynamicContent.appendChild(iframe);

            } else if (type === 'listing') {
                modalContentContainer.classList.add('listing');
                const dirData = allDirectoryData[data.directoryId];
                const listingContainer = document.createElement('div');
                listingContainer.className = 'dir-listing-container';
                listingContainer.innerHTML = `<h3>${dirData.basePath || 'æ–‡ä»¶åˆ—è¡¨'}</h3>`;
                
                const ul = document.createElement('ul');
                for (const folder in dirData.contents) {
                    const folderLi = document.createElement('li');
                    folderLi.textContent = folder;
                    folderLi.classList.add('is-folder');
                    ul.appendChild(folderLi);
                    
                    const innerUl = document.createElement('ul');
                    folderLi.appendChild(innerUl);

                    if (dirData.contents[folder].length > 0) {
                        folderLi.addEventListener('click', (e) => {
                            if (e.target === folderLi) {
                                innerUl.classList.toggle('expanded');
                            }
                        });

                        dirData.contents[folder].forEach(fileName => {
                            const fileLi = document.createElement('li');
                            fileLi.textContent = fileName;
                            fileLi.className = 'is-file';
                            const fullPath = [dirData.basePath, folder, fileName].filter(p => p).join('/');
                            const ext = fileName.split('.').pop().toLowerCase();

                            if (['jpg', 'png', 'gif'].includes(ext)) fileLi.classList.add('is-image');
                            else if (ext === 'pdf') fileLi.classList.add('is-pdf');
                            
                            fileLi.addEventListener('click', () => {
                                const previewType = ['jpg', 'png', 'gif'].includes(ext) ? 'image' : (ext === 'pdf' ? 'pdf' : null);
                                if (previewType) {
                                    renderModalContent('preview', {
                                        docType: previewType,
                                        filePath: fullPath,
                                        backContext: { type: 'listing', data: { directoryId: data.directoryId } }
                                    });
                                } else {
                                    alert('This file type cannot be previewed.');
                                }
                            });
                            innerUl.appendChild(fileLi);
                        });
                    }
                }
                listingContainer.appendChild(ul);
                modalDynamicContent.appendChild(listingContainer);

            } else if (type === 'preview') {
                modalContentContainer.classList.add('document');
                const previewContainer = document.createElement('div');
                previewContainer.className = 'preview-container';

                const backBtn = document.createElement('button');
                backBtn.textContent = 'â† è¿”å›åˆ—è¡¨';
                backBtn.className = 'back-btn';
                backBtn.onclick = () => renderModalContent(data.backContext.type, data.backContext.data);
                previewContainer.appendChild(backBtn);

                const content = document.createElement('div');
                content.className = 'preview-content';
                
                if (data.docType === 'image') {
                    const img = document.createElement('img');
                    img.src = data.filePath;
                    img.style.width = '100%';
                    img.style.height = '100%';
                    img.style.objectFit = 'contain';
                    content.appendChild(img);
                } else { // pdf
                    const iframe = document.createElement('iframe');
                    iframe.src = data.filePath;
                    iframe.style.width = '100%';
                    iframe.style.height = '100%';
                    iframe.frameBorder = '0';
                    content.appendChild(iframe);
                }
                previewContainer.appendChild(content);
                modalDynamicContent.appendChild(previewContainer);
            }
        };

        document.querySelectorAll('.view-btn').forEach(button => {
            if (button.classList.contains('disabled')) return;
            button.addEventListener('click', () => {
                const { modalType, files, docType, filePath, directoryId } = button.dataset;
                renderModalContent(modalType, { 
                    files: files ? JSON.parse(files) : null,
                    docType, 
                    filePath, 
                    directoryId 
                });
                openModal();
            });
        });
    });
    </script>

</body>
</html>